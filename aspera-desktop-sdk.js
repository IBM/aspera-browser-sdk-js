/*! For license information please see aspera-desktop-sdk.js.LICENSE.txt */
(()=>{"use strict";var e={779:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.JSONRPCClient=void 0;var i=r(738),a=r(165),s=function(){function e(e,t){this._send=e,this.createID=t,this.idToResolveMap=new Map,this.id=0}return e.prototype._createID=function(){return this.createID?this.createID():++this.id},e.prototype.timeout=function(e,t){var r=this;void 0===t&&(t=function(e){return(0,i.createJSONRPCErrorResponse)(e,a.DefaultErrorCode,"Request timeout")});var n=function(n,o){var i=setTimeout((function(){n.forEach((function(e){var n=r.idToResolveMap.get(e);n&&(r.idToResolveMap.delete(e),n(t(e)))}))}),e);return o().then((function(e){return clearTimeout(i),e}),(function(e){return clearTimeout(i),Promise.reject(e)}))};return{request:function(e,t,o){var i=r._createID();return n([i],(function(){return r.requestWithID(e,t,o,i)}))},requestAdvanced:function(e,t){return function(e,t){var o=(Array.isArray(e)?e:[e]).map((function(e){return e.id})).filter(c);return n(o,(function(){return r.requestAdvanced(e,t)}))}(e,t)}}},e.prototype.request=function(e,t,r){return this.requestWithID(e,t,r,this._createID())},e.prototype.requestWithID=function(e,t,r,a){return n(this,void 0,void 0,(function(){var n,s;return o(this,(function(o){switch(o.label){case 0:return n=(0,i.createJSONRPCRequest)(a,e,t),[4,this.requestAdvanced(n,r)];case 1:return void 0===(s=o.sent()).result||s.error?void 0===s.result&&s.error?[2,Promise.reject(new i.JSONRPCErrorException(s.error.message,s.error.code,s.error.data))]:[2,Promise.reject(new Error("An unexpected error occurred"))]:[2,s.result]}}))}))},e.prototype.requestAdvanced=function(e,t){var r=this,n=Array.isArray(e);Array.isArray(e)||(e=[e]);var o=e.filter((function(e){return c(e.id)})),s=o.map((function(e){return new Promise((function(t){return r.idToResolveMap.set(e.id,t)}))})),u=Promise.all(s).then((function(e){return n||!e.length?e:e[0]}));return this.send(n?e:e[0],t).then((function(){return u}),(function(e){return o.forEach((function(t){r.receive((0,i.createJSONRPCErrorResponse)(t.id,a.DefaultErrorCode,e&&e.message||"Failed to send a request"))})),u}))},e.prototype.notify=function(e,t,r){var n=(0,i.createJSONRPCNotification)(e,t);this.send(n,r).then(void 0,(function(){}))},e.prototype.send=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this._send(e,t)]}))}))},e.prototype.rejectAllPendingRequests=function(e){this.idToResolveMap.forEach((function(t,r){return t((0,i.createJSONRPCErrorResponse)(r,a.DefaultErrorCode,e))})),this.idToResolveMap.clear()},e.prototype.receive=function(e){var t=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){var r=t.idToResolveMap.get(e.id);r&&(t.idToResolveMap.delete(e.id),r(e))}))},e}();t.JSONRPCClient=s;var c=function(e){return null!=e}},569:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(779),t),o(r(891),t),o(r(738),t),o(r(479),t),o(r(451),t)},891:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},165:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultErrorCode=void 0,t.DefaultErrorCode=0},738:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.createJSONRPCNotification=t.createJSONRPCRequest=t.createJSONRPCSuccessResponse=t.createJSONRPCErrorResponse=t.JSONRPCErrorCode=t.JSONRPCErrorException=t.isJSONRPCResponses=t.isJSONRPCResponse=t.isJSONRPCRequests=t.isJSONRPCRequest=t.isJSONRPCID=t.JSONRPC=void 0,t.JSONRPC="2.0",t.isJSONRPCID=function(e){return"string"==typeof e||"number"==typeof e||null===e},t.isJSONRPCRequest=function(e){return e.jsonrpc===t.JSONRPC&&void 0!==e.method&&void 0===e.result&&void 0===e.error},t.isJSONRPCRequests=function(e){return Array.isArray(e)&&e.every(t.isJSONRPCRequest)},t.isJSONRPCResponse=function(e){return e.jsonrpc===t.JSONRPC&&void 0!==e.id&&(void 0!==e.result||void 0!==e.error)},t.isJSONRPCResponses=function(e){return Array.isArray(e)&&e.every(t.isJSONRPCResponse)};var o,i=function(e,t,r){var n={code:e,message:t};return null!=r&&(n.data=r),n},a=function(e){function t(r,n,o){var i=e.call(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i.code=n,i.data=o,i}return n(t,e),t.prototype.toObject=function(){return i(this.code,this.message,this.data)},t}(Error);t.JSONRPCErrorException=a,(o=t.JSONRPCErrorCode||(t.JSONRPCErrorCode={}))[o.ParseError=-32700]="ParseError",o[o.InvalidRequest=-32600]="InvalidRequest",o[o.MethodNotFound=-32601]="MethodNotFound",o[o.InvalidParams=-32602]="InvalidParams",o[o.InternalError=-32603]="InternalError",t.createJSONRPCErrorResponse=function(e,r,n,o){return{jsonrpc:t.JSONRPC,id:e,error:i(r,n,o)}},t.createJSONRPCSuccessResponse=function(e,r){return{jsonrpc:t.JSONRPC,id:e,result:null!=r?r:null}},t.createJSONRPCRequest=function(e,r,n){return{jsonrpc:t.JSONRPC,id:e,method:r,params:n}},t.createJSONRPCNotification=function(e,r){return{jsonrpc:t.JSONRPC,method:e,params:r}}},451:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.JSONRPCServerAndClient=void 0;var i=r(738),a=function(){function e(e,t,r){var n;void 0===r&&(r={}),this.server=e,this.client=t,this.errorListener=null!==(n=r.errorListener)&&void 0!==n?n:console.warn}return e.prototype.applyServerMiddleware=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this.server).applyMiddleware.apply(e,t)},e.prototype.hasMethod=function(e){return this.server.hasMethod(e)},e.prototype.addMethod=function(e,t){this.server.addMethod(e,t)},e.prototype.addMethodAdvanced=function(e,t){this.server.addMethodAdvanced(e,t)},e.prototype.timeout=function(e){return this.client.timeout(e)},e.prototype.request=function(e,t,r){return this.client.request(e,t,r)},e.prototype.requestAdvanced=function(e,t){return this.client.requestAdvanced(e,t)},e.prototype.notify=function(e,t,r){this.client.notify(e,t,r)},e.prototype.rejectAllPendingRequests=function(e){this.client.rejectAllPendingRequests(e)},e.prototype.receiveAndSend=function(e,t,r){return n(this,void 0,void 0,(function(){var n,a;return o(this,(function(o){switch(o.label){case 0:return(0,i.isJSONRPCResponse)(e)||(0,i.isJSONRPCResponses)(e)?(this.client.receive(e),[3,4]):[3,1];case 1:return(0,i.isJSONRPCRequest)(e)||(0,i.isJSONRPCRequests)(e)?[4,this.server.receive(e,t)]:[3,3];case 2:return(n=o.sent())?[2,this.client.send(n,r)]:[3,4];case 3:return a="Received an invalid JSON-RPC message",this.errorListener(a,e),[2,Promise.reject(new Error(a))];case 4:return[2]}}))}))},e}();t.JSONRPCServerAndClient=a},479:function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},a=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.JSONRPCServer=void 0;var s=r(738),c=r(165),u=function(e){return(0,s.createJSONRPCErrorResponse)((0,s.isJSONRPCID)(e.id)?e.id:null,s.JSONRPCErrorCode.InvalidRequest,"Invalid Request")},l=function(){function e(e){var t;void 0===e&&(e={}),this.mapErrorToJSONRPCErrorResponse=h,this.nameToMethodDictionary={},this.middleware=null,this.errorListener=null!==(t=e.errorListener)&&void 0!==t?t:console.warn}return e.prototype.hasMethod=function(e){return!!this.nameToMethodDictionary[e]},e.prototype.addMethod=function(e,t){this.addMethodAdvanced(e,this.toJSONRPCMethod(t))},e.prototype.toJSONRPCMethod=function(e){return function(t,r){var n=e(t.params,r);return Promise.resolve(n).then((function(e){return p(t.id,e)}))}},e.prototype.addMethodAdvanced=function(e,t){var r;this.nameToMethodDictionary=n(n({},this.nameToMethodDictionary),((r={})[e]=t,r))},e.prototype.receiveJSON=function(e,t){var r=this.tryParseRequestJSON(e);return r?this.receive(r,t):Promise.resolve((0,s.createJSONRPCErrorResponse)(null,s.JSONRPCErrorCode.ParseError,"Parse error"))},e.prototype.tryParseRequestJSON=function(e){try{return JSON.parse(e)}catch(e){return null}},e.prototype.receive=function(e,t){return Array.isArray(e)?this.receiveMultiple(e,t):this.receiveSingle(e,t)},e.prototype.receiveMultiple=function(e,t){return o(this,void 0,void 0,(function(){var r,n=this;return i(this,(function(o){switch(o.label){case 0:return[4,Promise.all(e.map((function(e){return n.receiveSingle(e,t)})))];case 1:return 1===(r=o.sent().filter(f)).length?[2,r[0]]:r.length?[2,r]:[2,null]}}))}))},e.prototype.receiveSingle=function(e,t){return o(this,void 0,void 0,(function(){var r,n;return i(this,(function(o){switch(o.label){case 0:return r=this.nameToMethodDictionary[e.method],(0,s.isJSONRPCRequest)(e)?[3,1]:[2,u(e)];case 1:return[4,this.callMethod(r,e,t)];case 2:return n=o.sent(),[2,v(e,n)]}}))}))},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.middleware?this.middleware=this.combineMiddlewares(a([this.middleware],e,!0)):this.middleware=this.combineMiddlewares(e)},e.prototype.combineMiddlewares=function(e){return e.length?e.reduce(this.middlewareReducer):null},e.prototype.middlewareReducer=function(e,t){return function(r,n,o){return e((function(e,n){return t(r,e,n)}),n,o)}},e.prototype.callMethod=function(e,t,r){var n=this,o=function(e){return n.errorListener('An unexpected error occurred while executing "'.concat(t.method,'" JSON-RPC method:'),e),Promise.resolve(n.mapErrorToJSONRPCErrorResponseIfNecessary(t.id,e))};try{return(this.middleware||d)((function(t,r){return e?e(t,r):void 0!==t.id?Promise.resolve((n=t.id,(0,s.createJSONRPCErrorResponse)(n,s.JSONRPCErrorCode.MethodNotFound,"Method not found"))):Promise.resolve(null);var n}),t,r).then(void 0,o)}catch(e){return o(e)}},e.prototype.mapErrorToJSONRPCErrorResponseIfNecessary=function(e,t){return void 0!==e?this.mapErrorToJSONRPCErrorResponse(e,t):null},e}();t.JSONRPCServer=l;var f=function(e){return null!==e},d=function(e,t,r){return e(t,r)},p=function(e,t){return void 0!==e?(0,s.createJSONRPCSuccessResponse)(e,t):null},h=function(e,t){var r,n,o=null!==(r=null==t?void 0:t.message)&&void 0!==r?r:"An unexpected error occurred",i=c.DefaultErrorCode;return t instanceof s.JSONRPCErrorException&&(i=t.code,n=t.data),(0,s.createJSONRPCErrorResponse)(e,i,o,n)},v=function(e,t){return t||(void 0!==e.id?(0,s.createJSONRPCErrorResponse)(e.id,s.JSONRPCErrorCode.InternalError,"Internal error"):null)}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};(()=>{r.d(n,{tz:()=>q});var e=function(){var e,t;return{promise:new Promise((function(r,n){e=r,t=n})),resolver:e,rejecter:t}},t=function(e,t){t&&t.code&&t.message&&(t={code:t.code,message:t.message,data:t.data}),"object"==typeof window&&(Array.isArray(window.asperaDesktopLogs)||(window.asperaDesktopLogs=[]),window.asperaDesktopLogs.push({message:e,debugData:t})),console.warn("Aspera Desktop SDK: ".concat(e),t)},o=function(e,t){var r={error:!0,message:e};return t&&t.code&&t.message&&(r.debugData={code:t.code,message:t.message,data:t.data}),r},i=function(e,r){return t(e,r),new Promise((function(t,n){n(o(e,r))}))},a=function(e){try{return new URL(e),!0}catch(e){return!1}},s="The provided callback is not a function",c="Unable to initialize drag-drop",u="Unable to generate IFRAME for download. Using new window",l="Unable to get latest installers",f="Unable to get all transfers",d="Unable to get transfer",p="Unable to remove transfer",h="Unable to connect to IBM Aspera Desktop server",v="IBM Aspera Desktop has not been verified. Run test or init first",y="Unable to set custom branding",b="Unable to show transfer directory",m="Unable to show select file dialog",g="Unable to show select folder dialog",R="Unable to show preferences",w="Unable to stop transfer",C="Unable to resume transfer",S="Unable to modify transfer",P="The transfer failed to initiate",k=new(function(){function r(){var r=this;this.sockets=new Map,this.hasClosed=!1,this.restartingWebsocket=!1,this.initPromise=e(),this.handleOpen=function(){r.restartingWebsocket=!1,r.joinChannel(),"function"==typeof r.eventListener&&(r.hasClosed=!1,r.eventListener("RECONNECT"))},this.handleClosed=function(){r.restartingWebsocket=!1,r.hasClosed||"function"!=typeof r.eventListener||(r.hasClosed=!0,r.eventListener("CLOSED")),r.handleDisconnect()},this.handleError=function(){t("The websocket was closed due to an error"),r.restartingWebsocket=!1},this.handleMessage=function(e){r.restartingWebsocket=!1;var t=JSON.parse(e.data);if(1!==t.id){var n=r.sockets.get(t.method);n&&t.params&&n(t.params)}else r.initPromise.resolver(t)}}return r.prototype.handleNotReady=function(){t("The websocket is not ready. Run init first")},r.prototype.handleDisconnect=function(){var e=this;this.globalSocket?this.restartingWebsocket||(this.restartingWebsocket=!0,setTimeout((function(){e.globalSocket.close(),e.init(e.websocketUrl,e.appId)}),3e3)):this.handleNotReady()},r.prototype.joinChannel=function(){this.globalSocket?this.globalSocket.send(JSON.stringify({jsonrpc:"2.0",method:"subscribe_transfer_activity",params:[this.appId],id:1})):this.handleNotReady()},r.prototype.registerMessage=function(e,t){this.sockets.get(e)||this.sockets.set(e,(function(e){t(e.result)}))},r.prototype.registerEvent=function(e){this.eventListener=e},r.prototype.init=function(e,t){return this.websocketUrl=e,this.appId=t,this.globalSocket=new WebSocket(this.websocketUrl),this.globalSocket.onerror=this.handleError,this.globalSocket.onclose=this.handleClosed,this.globalSocket.onopen=this.handleOpen,this.globalSocket.onmessage=this.handleMessage,this.initPromise.promise},r}()),O="aspera://",_=function(){function e(){this.desktopUrl="http://127.0.0.1:33024",this.installerUrl="https://d3gcli72yxqn2z.cloudfront.net/downloads/desktop/latest/stable",this.desktopVerified=!1,this.dropzonesCreated=new Map}return e.prototype.backupLaunchMethod=function(e){window.alert("Launching IBM Aspera for Desktop"),window.location.href=e},e.prototype.launch=function(){var e=this;try{var r=document.createElement("iframe");r.src=O,r.onerror=function(r){t(u,r),e.backupLaunchMethod(O)},r.setAttribute("style","\n  display: none !important;\n  width: 1px !important;\n  height: 1px !important;\n  position: fixed !important;\n  z-index: -99 !important;\n  bottom: 0px !important;\n  right: 0px !important;\n"),document.body.appendChild(r)}catch(e){t(u,e),this.backupLaunchMethod(O)}},e}(),N=function(){function e(){this.activity_callbacks=new Map,this.removed_callbacks=new Map,this.event_callbacks=new Map}return e.prototype.handleTransferActivity=function(e){"transferUpdated"===e.type&&this.activity_callbacks.forEach((function(t){"function"==typeof t&&t(e.data)})),"transferRemoved"===e.type&&this.removed_callbacks.forEach((function(t){"function"==typeof t&&t(e.data)}))},e.prototype.handleWebSocketEvents=function(e){this.event_callbacks.forEach((function(t){"function"==typeof t&&t(e)}))},e.prototype.setup=function(e,t){var r=this;return k.init(e,t).then((function(e){return k.registerMessage("transfer_activity",(function(e){return r.handleTransferActivity(e)})),k.registerEvent((function(e){return r.handleWebSocketEvents(e)})),e}))},e.prototype.setCallback=function(e){if("function"==typeof e){var r="callback-".concat(this.activity_callbacks.size+1);return this.activity_callbacks.set(r,e),r}t(s)},e.prototype.removeCallback=function(e){this.activity_callbacks.delete(e)},e.prototype.setRemovedCallback=function(e){if("function"==typeof e){var r="callback-".concat(this.removed_callbacks.size+1);return this.removed_callbacks.set(r,e),r}t(s)},e.prototype.removeRemovedCallback=function(e){this.removed_callbacks.delete(e)},e.prototype.setWebSocketEventCallback=function(e){if("function"==typeof e){var r="callback-".concat(this.event_callbacks.size+1);return this.event_callbacks.set(r,e),r}t(s)},e.prototype.removeWebSocketEventCallback=function(e){this.event_callbacks.delete(e)},e}(),E=function(){function e(){this.globals=new _,this.activityTracking=new N}return Object.defineProperty(e.prototype,"isReady",{get:function(){return this.globals.desktopVerified&&""!==this.globals.appId},enumerable:!1,configurable:!0}),e}(),J=r(569),x=function(){var e=this;this.handleRequest=function(t){var r={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)};return fetch(q.globals.desktopUrl,r).then((function(r){if(r.ok)return r.json().then((function(t){return e.client.receive(t)}));if(void 0!==t.id)throw Promise.reject(new Error(r.statusText))}))},this.request=function(t,r){return e.client.request(t,r)},this.client=new J.JSONRPCClient(this.handleRequest)},M=new function(){var t=this;this.request=function(r,n){return void 0===n&&(n={}),o=t.httpClient.request(r,n),i=e(),o.then((function(e){i.resolver(e)}),(function(e){i.rejecter(e)})),i.promise;var o,i},this.httpClient=new x},j=function(){return M.request("get_info").then((function(e){return q.globals.desktopInfo=e,q.globals.desktopVerified=!0,e}))},T=function(){if(!q.isReady)return i(v);var r=e();return M.request("init_drag_drop").then((function(e){return r.resolver(e)})).catch((function(e){t(c,e),r.rejecter(o(c,e))})),r.promise},q=new E;q.initDesktop=function(e){return q.globals.appId=e||((null===(r=window.crypto)||void 0===r?void 0:r.randomUUID)?window.crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=Number((((new Date).getTime()+16)*Math.random()).toFixed())%16;return"x"!==e&&(t=3&t|8),t.toString(16)}))),q.activityTracking.setup(function(e){var t;0===e.indexOf("http:")?t="ws":0===e.indexOf("https:")&&(t="wss");var r=e.replace("http://","//").replace("https://","//");return"".concat(t,":").concat(r)}(q.globals.desktopUrl),q.globals.appId).then((function(){return j()})).then((function(){return T()})).catch((function(e){return t(h,e),q.globals.desktopVerified=!1,o(h,e)}));var r},q.testDesktopConnection=j,q.startTransfer=function(r,n){if(!q.isReady)return i(v);if(!function(e){return!(!e||"object"!=typeof e||"string"!=typeof e.direction||"string"!=typeof e.remote_host||!Array.isArray(e.paths))}(r))return i("The supplied transferSpec is not valid",{transferSpec:r});var a=e(),s={transfer_spec:r,desktop_spec:n,app_id:q.globals.appId};return M.request("start_transfer",s).then((function(e){return a.resolver(e)})).catch((function(e){t(P,e),a.rejecter(o(P,e))})),a.promise},q.registerActivityCallback=function(e){return q.activityTracking.setCallback(e)},q.deregisterActivityCallback=function(e){q.activityTracking.removeCallback(e)},q.removeTransfer=function(r){if(!q.isReady)return i(v);var n=e(),a={transfer_id:r};return M.request("remove_transfer",a).then((function(e){return n.resolver(e)})).catch((function(e){t(p,e),n.rejecter(o(p,e))})),n.promise},q.showDirectory=function(r){if(!q.isReady)return i(v);var n=e(),a={transfer_id:r};return M.request("show_directory",a).then((function(e){return n.resolver(e)})).catch((function(e){t(b,e),n.rejecter(o(b,e))})),n.promise},q.stopTransfer=function(r){if(!q.isReady)return i(v);var n=e(),a={transfer_id:r};return M.request("stop_transfer",a).then((function(e){return n.resolver(e)})).catch((function(e){t(w,e),n.rejecter(o(w,e))})),n.promise},q.resumeTransfer=function(r,n){if(!q.isReady)return i(v);var a=e(),s={transfer_id:r,transfer_spec:n};return M.request("resume_transfer",s).then((function(e){return a.resolver(e)})).catch((function(e){t(C,e),a.rejecter(o(C,e))})),a.promise},q.getAllTransfers=function(){if(!q.isReady)return i(v);var r=e(),n={app_id:q.globals.appId};return M.request("get_all_transfers",n).then((function(e){return r.resolver(e)})).catch((function(e){t(f,e),r.rejecter(o(f,e))})),r.promise},q.getTransfer=function(r){if(!q.isReady)return i(v);var n=e(),a={transfer_id:r};return M.request("get_transfer",a).then((function(e){return n.resolver(e)})).catch((function(e){t(d,e),n.rejecter(o(d,e))})),n.promise},q.registerRemovedCallback=function(e){return q.activityTracking.setRemovedCallback(e)},q.deregisterRemovedCallback=function(e){q.activityTracking.removeRemovedCallback(e)},q.showSelectFileDialog=function(r){if(!q.isReady)return i(v);var n=e(),a={options:r||{},app_id:q.globals.appId};return M.request("show_file_dialog",a).then((function(e){return n.resolver(e)})).catch((function(e){t(m,e),n.rejecter(o(m,e))})),n.promise},q.showSelectFolderDialog=function(r){if(!q.isReady)return i(v);var n=e(),a={options:r||{},app_id:q.globals.appId};return M.request("show_folder_dialog",a).then((function(e){return n.resolver(e)})).catch((function(e){t(g,e),n.rejecter(o(g,e))})),n.promise},q.showPreferences=function(){if(!q.isReady)return i(v);var r=e();return M.request("open_preferences").then((function(e){return r.resolver(e)})).catch((function(e){t(R,e),r.rejecter(o(R,e))})),r.promise},q.modifyTransfer=function(r,n){if(!q.isReady)return i(v);var a=e(),s={transfer_id:r,transfer_spec:n};return M.request("modify_transfer",s).then((function(e){return a.resolver(e)})).catch((function(e){t(S,e),a.rejecter(o(S,e))})),a.promise},q.createDropzone=function(e,r){var n=document.querySelectorAll(r);if(n&&n.length){var o=function(e){e.preventDefault()},i=function(r){r.preventDefault();var n=[];if(r.dataTransfer&&r.dataTransfer.files&&r.dataTransfer.files.length&&r.dataTransfer.files[0]){for(var o=0;o<r.dataTransfer.files.length;o++){var i=r.dataTransfer.files[o];n.push({lastModified:i.lastModified,name:i.name,size:i.size,type:i.type})}var a={files:n,app_id:q.globals.appId};M.request("dropped_files",a).then((function(t){return e({event:r,files:t})})).catch((function(e){t("The dropped item could not be parsed. Please try selecting via the select file/folder option",e)}))}};n.forEach((function(e){e.addEventListener("dragover",o),e.addEventListener("drop",i),q.globals.dropzonesCreated.set(r,[{event:"dragover",callback:o},{event:"drop",callback:i}])}))}else t("Unable to find the element on the current page")},q.removeDropzone=function(e){var t=q.globals.dropzonesCreated.get(e);t&&t.forEach((function(t){var r=document.querySelectorAll(e);r&&r.length&&r.forEach((function(e){e.removeEventListener(t.event,t.callback)}))}))},q.getInstallerInfo=function(r){void 0===r&&(r={});var n=r.endpoint||q.globals.installerUrl;if(n.endsWith("/latest.json")&&(n=n.replace("/latest.json","")),!a(n))return i("The specified endpoint is not a valid URL",{url:n});var s=e();return function(t){return r=fetch(t,{headers:{"Content-Type":"application/json"}}),n=e(),r.then((function(e){return e.ok?n.resolver(e):n.rejecter(e),e})).catch((function(e){n.rejecter(e)})),n.promise;var r,n}("".concat(n,"/latest.json")).then((function(e){e.json().then((function(e){if(r.endpoint)for(var t=0,n=e.entries;t<n.length;t++){var o=n[t];a(o.url)||(o.url="".concat(r.endpoint,"/").concat(o.url))}if(r.all)s.resolver(e);else{var i=(c=navigator.userAgent,/Mac/.test(c)?"macos":/Win/.test(c)?"windows":/Linux/.test(c)?"linux":"unknown");e.entries=e.entries.filter((function(e){return e.platform===i})),s.resolver(e)}var c}))})).catch((function(e){t(l,e),s.rejecter(o(l,e))})),s.promise},q.registerStatusCallback=function(e){return q.activityTracking.setWebSocketEventCallback(e)},q.deregisterStatusCallback=function(e){q.activityTracking.removeWebSocketEventCallback(e)},q.initDragDrop=T,q.setBranding=function(r,n){if(!q.isReady)return i(v);var a=e(),s={branding:{id:r,name:n.name,theme:n.theme}};return M.request("update_branding",s).then((function(e){return a.resolver(e)})).catch((function(e){t(y,e),a.rejecter(o(y,e))})),a.promise};var A=q.globals.launch;q.launch=A,"object"==typeof window&&(window.asperaDesktop=q)})()})();
//# sourceMappingURL=aspera-desktop-sdk.js.map